set(BUILD_SHARED_LIBS ON) # assimp contains polyclipper. Build static lib makes conflicts.
set(BUILD_TESTING OFF)

set(ASSIMP_OPT_BUILD_PACKAGES OFF CACHE BOOL "" FORCE)
set(ASSIMP_ANDROID_JNIIOSYSTEM OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_ALL_IMPORTERS_BY_DEFAULT ON CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_ALL_EXPORTERS_BY_DEFAULT ON CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_ASSIMP_TOOLS OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_ASSIMP_VIEW OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_DOCS OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_NONFREE_C4D_IMPORTER OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_SAMPLES OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_TESTS OFF CACHE BOOL "" FORCE)
set(ASSIMP_BUILD_ZLIB OFF CACHE BOOL "" FORCE)
set(ASSIMP_IGNORE_GIT_HASH ON CACHE BOOL "" FORCE)
set(ASSIMP_INJECT_DEBUG_POSTFIX OFF CACHE BOOL "" FORCE)
set(ASSIMP_INSTALL OFF CACHE BOOL "" FORCE)
set(ASSIMP_INSTALL_PDB OFF CACHE BOOL "" FORCE)
set(ASSIMP_NO_EXPORT OFF CACHE BOOL "" FORCE)
set(ASSIMP_RAPIDJSON_NO_MEMBER_ITERATOR ON CACHE BOOL "" FORCE)

add_subdirectory(assimp EXCLUDE_FROM_ALL)

if(CMAKE_C_COMPILER_ID MATCHES Clang)
  target_compile_options(assimp
   PRIVATE
    -Wno-deprecated-copy
    -Wno-unused-function
    -Wno-unused-variable
  )

  target_compile_options(zlibstatic
   PRIVATE
    -Wno-deprecated-non-prototype
  )
endif()

set_target_properties(assimp PROPERTIES FOLDER "3rdparty")

set(3RDPARTY_INCLUDES ${3RDPARTY_INCLUDES} 
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/assimp/include
    PARENT_SCOPE)

set(3RDPARTY_DLLS ${3RDPARTY_DLLS} 
    ${CMAKE_CURRENT_BINARY_DIR}/assimp/bin/assimp-vc143-mt.dll
    PARENT_SCOPE)

set(3RDPARTY_PDBS ${3RDPARTY_PDBS} 
    ${CMAKE_CURRENT_BINARY_DIR}/assimp/bin/assimp-vc143-mt.pdb
    PARENT_SCOPE)